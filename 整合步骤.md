# ğŸ“ å°†ä»£ç†æœåŠ¡å™¨æ•´åˆåˆ° test-sq çš„è¯¦ç»†æ­¥éª¤

## å½“å‰æƒ…å†µ

- âœ… ä½ æœ‰ `test-sq` åº”ç”¨æ¡†æ¶ï¼ˆå·²åœ¨ Shopify Partners åˆ›å»ºï¼‰
- âœ… Client ID: `9853c81f5948bb94e3b2ebb45fbc7d78`
- âš ï¸ éœ€è¦æ·»åŠ ä»£ç†æœåŠ¡å™¨ä»£ç 

---

## Step 1: å¤åˆ¶æœåŠ¡å™¨ä»£ç 

### 1.1 å¤åˆ¶æ–‡ä»¶

å°†ä»¥ä¸‹æ–‡ä»¶ä» `shopify-proxy-app` å¤åˆ¶åˆ° `test-sq`ï¼š

```
å¤åˆ¶è¿™äº›æ–‡ä»¶ï¼š
shopify-proxy-app/server.js          â†’ test-sq/server.js
shopify-proxy-app/.env.example       â†’ test-sq/.env.example
shopify-proxy-app/ç¤ºä¾‹é…ç½®.env       â†’ test-sq/ç¤ºä¾‹é…ç½®.env
```

### 1.2 æ‰“å¼€ PowerShell æ‰§è¡Œ

```powershell
# è¿›å…¥ test-sq ç›®å½•
cd D:\self\shopifyApps\shopify-proxy-app\test-sq

# å¤åˆ¶ server.js
Copy-Item ..\server.js -Destination .\server.js

# å¤åˆ¶é…ç½®æ–‡ä»¶
Copy-Item ..\ç¤ºä¾‹é…ç½®.env -Destination .\ç¤ºä¾‹é…ç½®.env
```

---

## Step 2: ä¿®æ”¹ package.json

æ‰“å¼€ `test-sq/package.json`ï¼Œæ›´æ–°ä¸ºï¼š

```json
{
  "name": "test-sq",
  "version": "1.0.0",
  "license": "UNLICENSED",
  "type": "module",
  "scripts": {
    "shopify": "shopify",
    "build": "shopify app build",
    "dev": "node server.js",
    "start": "NODE_ENV=production node server.js",
    "info": "shopify app info",
    "generate": "shopify app generate",
    "deploy": "shopify app deploy"
  },
  "dependencies": {
    "express": "^4.18.2",
    "dotenv": "^16.3.1",
    "axios": "^1.6.2",
    "cors": "^2.8.5",
    "helmet": "^7.1.0",
    "compression": "^1.7.4"
  },
  "trustedDependencies": [
    "@shopify/plugin-cloudflare"
  ],
  "author": "PC",
  "private": true
}
```

---

## Step 3: ä¿®æ”¹ shopify.app.toml

æ‰“å¼€ `test-sq/shopify.app.toml`ï¼Œæ›´æ–°ä¸ºï¼š

```toml
# Learn more about configuring your app at https://shopify.dev/docs/apps/tools/cli/configuration

client_id = "9853c81f5948bb94e3b2ebb45fbc7d78"
name = "test-sq"
application_url = "https://your-app-url.com"  # éƒ¨ç½²åæ›¿æ¢
embedded = true

[build]
automatically_update_urls_on_dev = true
include_config_on_deploy = true

[webhooks]
api_version = "2026-01"

[access_scopes]
# æ·»åŠ  App Proxy æ‰€éœ€æƒé™
scopes = "write_app_proxy"

[auth]
redirect_urls = [
  "https://your-app-url.com/auth/callback"  # éƒ¨ç½²åæ›¿æ¢
]

# â­ æ·»åŠ  App Proxy é…ç½®
[app_proxy]
url = "/proxy"
prefix = "apps"
subpath = "a"
```

---

## Step 4: åˆ›å»º .env æ–‡ä»¶

åœ¨ `test-sq` ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# Shopify App é…ç½®
SHOPIFY_API_KEY=9853c81f5948bb94e3b2ebb45fbc7d78
SHOPIFY_API_SECRET=ä½ çš„Client_secret
SHOPIFY_APP_URL=https://your-app-url.com

# ä»£ç†ç›®æ ‡åŸŸåB
TARGET_DOMAIN=https://example.com

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# App Proxy é…ç½®
PROXY_PREFIX=apps
PROXY_SUBPATH=a
```

**è·å– Client Secretï¼š**
1. è®¿é—® https://partners.shopify.com/
2. æ‰¾åˆ°ä½ çš„ `test-sq` åº”ç”¨
3. åœ¨ "Client credentials" ä¸­æŸ¥çœ‹ Client secret

---

## Step 5: å®‰è£…ä¾èµ–

```powershell
cd D:\self\shopifyApps\shopify-proxy-app\test-sq

# å®‰è£…ä¾èµ–
npm install
```

---

## Step 6: æœ¬åœ°æµ‹è¯•ï¼ˆå¯é€‰ï¼‰

```powershell
# å¯åŠ¨æœåŠ¡å™¨
npm run dev
```

å¦‚æœæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                           â•‘
â•‘           ğŸš€ Shopify App Proxy Server å·²å¯åŠ¨              â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ æœåŠ¡å™¨åœ°å€: http://localhost:3000
ğŸ¯ ä»£ç†ç«¯ç‚¹: http://localhost:3000/proxy
ğŸ”— ç›®æ ‡åŸŸå: https://example.com
ğŸ“¦ Shopify è·¯å¾„: /apps/a
```

è®¿é—® http://localhost:3000 ç¡®è®¤æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ã€‚

---

## Step 7: éƒ¨ç½²åˆ°æœåŠ¡å™¨

ç°åœ¨ä½ éœ€è¦éƒ¨ç½²åˆ°å…¬ç½‘æœåŠ¡å™¨ã€‚é€‰æ‹©ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€ï¼š

### æ–¹å¼ A: ä½¿ç”¨ Railwayï¼ˆæ¨èï¼‰

#### 7.1 æ¨é€åˆ° GitHub

```powershell
cd D:\self\shopifyApps\shopify-proxy-app\test-sq

# åˆå§‹åŒ– git
git init

# æ·»åŠ æ–‡ä»¶
git add .

# æäº¤
git commit -m "Add proxy server"

# æ¨é€åˆ° GitHubï¼ˆå…ˆåœ¨ GitHub åˆ›å»ºä»“åº“ï¼‰
git remote add origin https://github.com/ä½ çš„ç”¨æˆ·å/test-sq.git
git branch -M main
git push -u origin main
```

#### 7.2 è¿æ¥ Railway

1. è®¿é—® https://railway.app
2. ç‚¹å‡» "New Project"
3. é€‰æ‹© "Deploy from GitHub repo"
4. é€‰æ‹© `test-sq` ä»“åº“
5. Railway ä¼šè‡ªåŠ¨éƒ¨ç½²

#### 7.3 é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway é¡¹ç›®ä¸­ï¼š
1. ç‚¹å‡» "Variables"
2. æ·»åŠ æ‰€æœ‰ .env ä¸­çš„å˜é‡
3. ç‰¹åˆ«æ˜¯ `SHOPIFY_API_SECRET` å’Œ `TARGET_DOMAIN`

#### 7.4 è·å–éƒ¨ç½² URL

1. ç‚¹å‡» "Settings"
2. åœ¨ "Domains" ç”ŸæˆåŸŸå
3. è®°å½• URLï¼Œä¾‹å¦‚ï¼š`https://test-sq.up.railway.app`

---

## Step 8: æ›´æ–° Shopify é…ç½®

### 8.1 æ›´æ–° shopify.app.toml

å°†éƒ¨ç½² URL æ›´æ–°åˆ°é…ç½®æ–‡ä»¶ï¼š

```toml
application_url = "https://test-sq.up.railway.app"

[auth]
redirect_urls = [
  "https://test-sq.up.railway.app/auth/callback"
]
```

### 8.2 æ›´æ–° Railway ç¯å¢ƒå˜é‡

æ›´æ–° `SHOPIFY_APP_URL`ï¼š

```
SHOPIFY_APP_URL=https://test-sq.up.railway.app
```

---

## Step 9: åœ¨ Shopify Partners é…ç½® App Proxy

1. è®¿é—® https://partners.shopify.com/
2. æ‰¾åˆ°ä½ çš„ `test-sq` åº”ç”¨
3. ç‚¹å‡» "Configuration"
4. æ›´æ–° **App URL**: `https://test-sq.up.railway.app`
5. æ›´æ–° **Allowed redirection URLs**: `https://test-sq.up.railway.app/auth/callback`
6. ä¿å­˜

### é…ç½® App Proxy

1. ç‚¹å‡» "Extensions" æ ‡ç­¾
2. ç‚¹å‡» "Create extension"
3. é€‰æ‹© "Online store" â†’ "App proxy"
4. é…ç½®ï¼š
   - **App proxy URL**: `https://test-sq.up.railway.app/proxy`
   - **Subpath prefix**: `apps`
   - **Subpath**: `a`
5. ä¿å­˜

---

## Step 10: å®‰è£…å¹¶æµ‹è¯•

### 10.1 å®‰è£…åº”ç”¨

1. åœ¨ Partners ä¸­ç‚¹å‡» "Test your app"
2. é€‰æ‹©ä½ çš„æµ‹è¯•åº—é“º
3. å®‰è£…åº”ç”¨

### 10.2 æµ‹è¯•è®¿é—®

è®¿é—®ï¼š

```
https://your-shop.myshopify.com/apps/a
```

**æˆåŠŸï¼** ğŸ‰ ä½ åº”è¯¥èƒ½çœ‹åˆ°åŸŸåBçš„å†…å®¹ã€‚

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

- [ ] Step 1: å¤åˆ¶ server.js åˆ° test-sq
- [ ] Step 2: ä¿®æ”¹ package.json
- [ ] Step 3: ä¿®æ”¹ shopify.app.toml
- [ ] Step 4: åˆ›å»º .env æ–‡ä»¶
- [ ] Step 5: è¿è¡Œ npm install
- [ ] Step 6: æœ¬åœ°æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- [ ] Step 7: éƒ¨ç½²åˆ° Railway
- [ ] Step 8: æ›´æ–°é…ç½®æ–‡ä»¶å’Œç¯å¢ƒå˜é‡
- [ ] Step 9: åœ¨ Partners é…ç½® App Proxy
- [ ] Step 10: å®‰è£…å¹¶æµ‹è¯•

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šnpm install å¤±è´¥

**è§£å†³ï¼š** åˆ é™¤ `node_modules` å’Œ `package-lock.json`ï¼Œé‡æ–°è¿è¡Œï¼š

```powershell
Remove-Item -Recurse -Force node_modules
Remove-Item package-lock.json
npm install
```

### é—®é¢˜ï¼šæœ¬åœ°è¿è¡ŒæŠ¥é”™

**æ£€æŸ¥ï¼š**
1. .env æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. ç«¯å£ 3000 æ˜¯å¦è¢«å ç”¨
3. ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´

### é—®é¢˜ï¼šéƒ¨ç½²åè®¿é—® 404

**æ£€æŸ¥ï¼š**
1. App Proxy é…ç½®æ˜¯å¦æ­£ç¡®
2. åº”ç”¨æ˜¯å¦å·²å®‰è£…åˆ°åº—é“º
3. Railway ç¯å¢ƒå˜é‡æ˜¯å¦é…ç½®å®Œæ•´

---

**ç°åœ¨å¼€å§‹ Step 1ï¼** ğŸš€

